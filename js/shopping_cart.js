"use strict";var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };var xmlhttp;function dom(e) {return document.getElementById(e);}function choose(e) {var t = 0,n = document.getElementsByClassName("choose"),l = dom("goods_numble"),o = dom("allmoneys");if (e.checked) {for (var r = 0; r < n.length; r++) {n[r].checked = !0;}for (var a = 1; a < n.length - 1; a++) {t += parseInt(n[a].parentElement.parentElement.children[4].children[0].innerHTML);}l.innerHTML = n.length - 2, o.innerHTML = "&yen;" + t;} else {for (r = 0; r < n.length; r++) {n[r].checked = !1;}l.innerHTML = "0", o.innerHTML = "0.00";}}function jian(e) {var t = e.nextElementSibling.value,n = e.parentElement.nextElementSibling.children[0],l = e.parentElement.previousElementSibling.children[0];"1" == t ? e.setAttribute("disabled", "disabled") : t -= 1, e.nextElementSibling.value = t, n.innerHTML = parseInt(l.innerHTML) * t, choose_son();}function add(e) {var t = parseInt(e.previousElementSibling.value),n = e.previousElementSibling.previousElementSibling,l = e.parentElement.nextElementSibling.children[0],o = e.parentElement.previousElementSibling.children[0];n.removeAttribute("disabled"), t++, l.innerHTML = parseInt(o.innerHTML) * t, e.previousElementSibling.value = t, choose_son();}function del(e) {var t = e.parentElement.parentElement,n = t.parentElement,l = document.getElementsByClassName("choose");if (confirm("确定删除本商品吗？")) {n.removeChild(t), console.log(window.localStorage.gouwucar), window.localStorage.gouwucar = window.localStorage.gouwucar - 1, console.log(window.localStorage.gouwucar), document.getElementById("gouwucar").innerHTML = window.localStorage.gouwucar;var o = t.children[1].children[0].src.substring(27);xmlhttp.open("GET", "php/del_cart.php?img=" + o, !0), xmlhttp.send();}2 == l.length && (l[0].checked = !1, l[l.length - 1].checked = !1, goods_numble.innerHTML = "0", allmoneys.innerHTML = "0.00"), choose_son();}function empty() {for (var e = !1, t = document.querySelectorAll(".choose"), n = 1; n < t.length - 1; n++) {if (t[n].checked) {e = !0;break;}}if (1 == e) {if (confirm("确认删除勾选的商品吗？")) {for (n = 0; n < t.length - 1; n++) {if (t[n].checked) {var l = t[n].parentElement.parentElement.parentElement,o = t[n].parentElement.parentElement;l.removeChild(o), window.localStorage.gouwucar = 0, document.getElementById("gouwucar").innerHTML = window.localStorage.gouwucar;}}xmlhttp.open("GET", "php/delall.php", !0), xmlhttp.send();}} else alert("请先勾选要删除的商品");choose_son();}function choose_son() {var e = !0,t = 0,n = 0,l = dom("goods_numble"),o = dom("allmoneys"),r = document.getElementsByClassName("choose");if (1 < r.length) for (var a = 1; a < r.length - 1; a++) {r[a].checked ? (n++, t += parseInt(r[a].parentElement.parentElement.children[4].children[0].innerHTML)) : e = !1, 0 == e ? (r[0].checked = !1, r[r.length - 1].checked = !1) : (r[0].checked = !0, r[r.length - 1].checked = !0), l.innerHTML = n, o.innerHTML = "&yen;" + t;} else l.innerHTML = "0", o.innerHTML = "0.00";}function is_number(e) {console.log(_typeof(parseFloat(e.value))), console.log(parseFloat(e.value)), 0 == /^[0-9]*$/.test(e.value) || "" == e.value ? e.value = 1 : parseFloat(e.value) < 1 ? e.value = 1 : /^\d+(\.\d+)?$/.test(e.value) ? e.value = parseInt(e.value) : e.value = parseFloat(e.value);}function zhifu() {var e = document.getElementById("goods_numble").innerHTML,t = document.getElementById("allmoneys").innerHTML.substring(1);"0" == e ? alert("请先勾选商品") : (window.localStorage.money_zhifu = t, window.open("address.html"));}xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP"), window.onload = function () {var e = window.localStorage.classname2,t = document.getElementById("login_user"),n = document.getElementById("head_user"),l = document.getElementById("register_user");(e ? (t.innerHTML = "欢迎你,", n.innerHTML = window.localStorage.classname2, l.innerHTML = "退出", l.href = "#", t.href = "#", l.onclick = function () {var e = document.getElementById("register_user").innerHTML;if (console.log(e), "注册" != e) {if (confirm("确定退出登录吗？")) return t.innerHTML = "登录", l.innerHTML = "注册", n.innerHTML = "", t.href = "login.html", window.localStorage.classname2 = "", document.getElementById("gouwucar").classList.remove("gouwucar"), document.getElementById("gouwucar").innerHTML = "", !1;} else l.href = "register.html";}) : (t.innerHTML = "登录", t.href = "login.html", l.innerHTML = "注册", n.innerHTML = "", l.href = "register.html"), "退出" == document.getElementById("register_user").innerHTML) && (document.getElementById("gouwucar").classList.add("gouwucar"), window.localStorage.gouwucar ? document.getElementById("gouwucar").innerHTML = window.localStorage.gouwucar : document.getElementById("gouwucar").innerHTML = "0");xmlhttp.open("GET", "php/get_cart.php", !0), xmlhttp.send(), xmlhttp.onreadystatechange = function () {if (4 == xmlhttp.readyState && 200 == xmlhttp.status) {for (var e = JSON.parse(xmlhttp.responseText), t = 0; t < e.length; t++) {var n = document.createElement("tr"),l = document.createElement("td"),o = document.createElement("input");o.type = "checkbox", o.classList.add("choose"), o.checked = "checked", o.setAttribute("onclick", "choose_son()"), l.appendChild(o), n.appendChild(l);var r = document.createElement("td"),a = document.createElement("img");a.setAttribute("src", e[t].img), a.classList.add("shopping_img");var i = document.createTextNode(e[t].name);r.appendChild(a), r.appendChild(i), n.appendChild(r);var c = document.createElement("td"),d = document.createTextNode("￥"),u = document.createElement("span");u.innerHTML = e[t].money, c.appendChild(d), c.appendChild(u), n.appendChild(c);var m = document.createElement("td"),s = document.createElement("input");s.type = "button", s.value = "-", s.setAttribute("size", "2"), s.setAttribute("id", "jian"), s.setAttribute("onclick", "jian(this)"), m.appendChild(s);var p = document.createElement("input");p.type = "text", p.setAttribute("size", "3"), p.value = e[t].shu, p.setAttribute("class", "shopping_num"), p.setAttribute("onblur", "is_number(this)"), m.appendChild(p);var h = document.createElement("input");h.type = "button", h.value = "+", h.setAttribute("size", "2"), h.setAttribute("id", "add"), h.setAttribute("onclick", "add(this)"), m.appendChild(h), n.appendChild(m);var g = document.createElement("td"),E = document.createTextNode("￥"),v = document.createElement("span");v.innerHTML = u.innerHTML * p.value, g.appendChild(E), g.appendChild(v), n.appendChild(g);var w = document.createElement("td"),T = document.createElement("a");T.href = "#", T.setAttribute("id", "del"), T.setAttribute("onclick", "del(this)"), T.innerHTML = "删除", T.textDecoration = "none", T.setAttribute("color", "white"), w.appendChild(T), n.appendChild(w), document.getElementById("shopping_cart").appendChild(n);}choose_son();}};};